;; gorilla-repl.fileformat = 1

;; **
;;; # Gaussian with Unknown Mean (AISTATS)
;;; 
;;; This is the Gaussian with unknown mean  benchmark from the 2014 AISTATS paper, with analytical posterior.
;; **

;; @@
(ns gaussian-aistats
  (:require [gorilla-plot.core :as plot]
            [clojure.core.matrix :as m]
            [anglican.stat :as s])
  (:use clojure.repl
        [anglican 
          core runtime emit 
          [state :only [get-predicts get-log-weight]]
          [inference :only [collect-by]]]))

(defn- square [x] (m/mul x x))

(defn kl-normal 
  "calculates the kl divergence beween two 
  normal distributions from parameters"
  [p-mean p-sigma q-mean q-sigma]
  (+ (- (log q-sigma)
     	(log p-sigma))
     (/ (+ (square p-sigma)
           (square (- p-mean
                      q-mean)))
        (* 2 (square q-sigma)))
     (/ -1 2)))           
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;gaussian-aistats/kl-normal</span>","value":"#'gaussian-aistats/kl-normal"}
;; <=

;; **
;;; ## Define model
;; **

;; @@
(defquery gaussian
  "Returns the posterior distribution on the mean 
  of a Gaussian, conditioned on observations"
  [observations sigma mu0 sigma0]
  (let [mu (sample (normal mu0 sigma0))
        likelihood (normal mu sigma)]
    (map (fn [obs]
              (observe likelihood obs))
         observations)
    mu))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;gaussian-aistats/gaussian</span>","value":"#'gaussian-aistats/gaussian"}
;; <=

;; **
;;; ## True Posterior
;; **

;; @@
(def posterior (normal 7.25 (sqrt (/ 1.0 1.2))))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;gaussian-aistats/posterior</span>","value":"#'gaussian-aistats/posterior"}
;; <=

;; **
;;; ## Run inference
;; **

;; @@
(def number-of-samples 100000)

(def samples
  (->> (doquery :rmh
                gaussian 
                [[9.0 8.0] (sqrt 2.0) 1.0 (sqrt 5.0)])
       (take number-of-samples)
       doall
       time))
;; @@
;; ->
;;; &quot;Elapsed time: 15494.988532 msecs&quot;
;;; 
;; <-
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;gaussian-aistats/samples</span>","value":"#'gaussian-aistats/samples"}
;; <=

;; **
;;; ## Plot Empirical Distribution vs True Posterior
;; **

;; @@
(def mu-values 
  (map :result samples))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;gaussian-aistats/mu-values</span>","value":"#'gaussian-aistats/mu-values"}
;; <=

;; @@
(plot/histogram mu-values)
;; @@
;; =>
;;; {"type":"vega","content":{"width":400,"height":247.2187957763672,"padding":{"top":10,"left":55,"bottom":40,"right":10},"data":[{"name":"b611459d-7b1e-443b-8d9d-1a88aa4d2389","values":[{"x":-0.9355083093952788,"y":0},{"x":-0.27574379596756793,"y":1.0},{"x":0.384020717460143,"y":0.0},{"x":1.043785230887854,"y":0.0},{"x":1.703549744315565,"y":0.0},{"x":2.363314257743276,"y":0.0},{"x":3.023078771170987,"y":1.0},{"x":3.682843284598698,"y":3.0},{"x":4.342607798026409,"y":89.0},{"x":5.00237231145412,"y":584.0},{"x":5.662136824881831,"y":3376.0},{"x":6.321901338309542,"y":11735.0},{"x":6.981665851737253,"y":22568.0},{"x":7.641430365164964,"y":27671.0},{"x":8.301194878592675,"y":21089.0},{"x":8.960959392020385,"y":9623.0},{"x":9.620723905448095,"y":2664.0},{"x":10.280488418875805,"y":550.0},{"x":10.940252932303515,"y":42.0},{"x":11.600017445731226,"y":4.0},{"x":12.259781959158936,"y":0}]}],"marks":[{"type":"line","from":{"data":"b611459d-7b1e-443b-8d9d-1a88aa4d2389"},"properties":{"enter":{"x":{"scale":"x","field":"data.x"},"y":{"scale":"y","field":"data.y"},"interpolate":{"value":"step-before"},"fill":{"value":"steelblue"},"fillOpacity":{"value":0.4},"stroke":{"value":"steelblue"},"strokeWidth":{"value":2},"strokeOpacity":{"value":1}}}}],"scales":[{"name":"x","type":"linear","range":"width","zero":false,"domain":{"data":"b611459d-7b1e-443b-8d9d-1a88aa4d2389","field":"data.x"}},{"name":"y","type":"linear","range":"height","nice":true,"zero":false,"domain":{"data":"b611459d-7b1e-443b-8d9d-1a88aa4d2389","field":"data.y"}}],"axes":[{"type":"x","scale":"x"},{"type":"y","scale":"y"}]},"value":"#gorilla_repl.vega.VegaView{:content {:width 400, :height 247.2188, :padding {:top 10, :left 55, :bottom 40, :right 10}, :data [{:name \"b611459d-7b1e-443b-8d9d-1a88aa4d2389\", :values ({:x -0.9355083093952788, :y 0} {:x -0.27574379596756793, :y 1.0} {:x 0.384020717460143, :y 0.0} {:x 1.043785230887854, :y 0.0} {:x 1.703549744315565, :y 0.0} {:x 2.363314257743276, :y 0.0} {:x 3.023078771170987, :y 1.0} {:x 3.682843284598698, :y 3.0} {:x 4.342607798026409, :y 89.0} {:x 5.00237231145412, :y 584.0} {:x 5.662136824881831, :y 3376.0} {:x 6.321901338309542, :y 11735.0} {:x 6.981665851737253, :y 22568.0} {:x 7.641430365164964, :y 27671.0} {:x 8.301194878592675, :y 21089.0} {:x 8.960959392020385, :y 9623.0} {:x 9.620723905448095, :y 2664.0} {:x 10.280488418875805, :y 550.0} {:x 10.940252932303515, :y 42.0} {:x 11.600017445731226, :y 4.0} {:x 12.259781959158936, :y 0})}], :marks [{:type \"line\", :from {:data \"b611459d-7b1e-443b-8d9d-1a88aa4d2389\"}, :properties {:enter {:x {:scale \"x\", :field \"data.x\"}, :y {:scale \"y\", :field \"data.y\"}, :interpolate {:value \"step-before\"}, :fill {:value \"steelblue\"}, :fillOpacity {:value 0.4}, :stroke {:value \"steelblue\"}, :strokeWidth {:value 2}, :strokeOpacity {:value 1}}}}], :scales [{:name \"x\", :type \"linear\", :range \"width\", :zero false, :domain {:data \"b611459d-7b1e-443b-8d9d-1a88aa4d2389\", :field \"data.x\"}} {:name \"y\", :type \"linear\", :range \"height\", :nice true, :zero false, :domain {:data \"b611459d-7b1e-443b-8d9d-1a88aa4d2389\", :field \"data.y\"}}], :axes [{:type \"x\", :scale \"x\"} {:type \"y\", :scale \"y\"}]}}"}
;; <=

;; @@
(let [mu-min (reduce min mu-values)
      mu-max (reduce max mu-values)]
  (plot/plot #(exp (observe* posterior %)) [mu-min mu-max]))
;; @@
;; =>
;;; {"type":"vega","content":{"width":400,"height":247.2187957763672,"padding":{"top":10,"left":55,"bottom":40,"right":10},"data":[{"name":"0005ecfd-f48d-462f-9c96-6d5d667a782f","values":[{"x":-0.9355083093952787,"y":1.5177457110710781E-18},{"x":-0.8167506963920248,"y":4.832064651664273E-18},{"x":-0.6979930833887709,"y":1.512573332331475E-17},{"x":-0.5792354703855169,"y":4.655326256718623E-17},{"x":-0.460477857382263,"y":1.4087495396429486E-16},{"x":-0.34172024437900905,"y":4.1914803278814316E-16},{"x":-0.22296263137575512,"y":1.2261710495065194E-15},{"x":-0.10420501837250118,"y":3.526831122451236E-15},{"x":0.014552594630752758,"y":9.973974461209923E-15},{"x":0.1333102076340067,"y":2.7733317261431563E-14},{"x":0.25206782063726063,"y":7.582027733782066E-14},{"x":0.37082543364051457,"y":2.0380690703070383E-13},{"x":0.4895830466437685,"y":5.386447217013132E-13},{"x":0.6083406596470224,"y":1.3997030194327666E-12},{"x":0.7270982726502764,"y":3.5761800096868163E-12},{"x":0.8458558856535303,"y":8.983650001799444E-12},{"x":0.9646134986567843,"y":2.2188924730070884E-11},{"x":1.0833711116600382,"y":5.388522131513146E-11},{"x":1.2021287246632921,"y":1.2866281991230112E-10},{"x":1.320886337666546,"y":3.0205528652976314E-10},{"x":1.4396439506698,"y":6.972199370552141E-10},{"x":1.558401563673054,"y":1.5823521236501393E-9},{"x":1.6771591766763079,"y":3.5309084068029774E-9},{"x":1.7959167896795618,"y":7.746753737857518E-9},{"x":1.9146744026828157,"y":1.6711022715021897E-8},{"x":2.0334320156860697,"y":3.5443474545609617E-8},{"x":2.1521896286893236,"y":7.391277879006082E-8},{"x":2.2709472416925776,"y":1.5154888711630995E-7},{"x":2.3897048546958315,"y":3.055174029508333E-7},{"x":2.5084624676990854,"y":6.05576671456206E-7},{"x":2.6272200807023394,"y":1.180191004737103E-6},{"x":2.7459776937055933,"y":2.2614419522515046E-6},{"x":2.8647353067088472,"y":4.260578482264893E-6},{"x":2.983492919712101,"y":7.892265296470874E-6},{"x":3.102250532715355,"y":1.4374235708139969E-5},{"x":3.221008145718609,"y":2.574055042667626E-5},{"x":3.339765758721863,"y":4.532114543208098E-5},{"x":3.458523371725117,"y":7.845739899387076E-5},{"x":3.577280984728371,"y":1.3354170473500436E-4},{"x":3.696038597731625,"y":2.2348578581065146E-4},{"x":3.8147962107348787,"y":3.677332307639632E-4},{"x":3.9335538237381327,"y":5.949299450079775E-4},{"x":4.052311436741387,"y":9.463434088037403E-4},{"x":4.1710690497446405,"y":0.0014800680201936516},{"x":4.2898266627478945,"y":0.0022759597059693755},{"x":4.408584275751148,"y":0.0034411011894398577},{"x":4.527341888754402,"y":0.005115408246139013},{"x":4.646099501757656,"y":0.00747675475325276},{"x":4.76485711476091,"y":0.010744741027638978},{"x":4.883614727764164,"y":0.015181991719543044},{"x":5.002372340767418,"y":0.02109169724291865},{"x":5.121129953770672,"y":0.028810068303938962},{"x":5.239887566773926,"y":0.038692521081368086},{"x":5.35864517977718,"y":0.05109280528809409},{"x":5.477402792780434,"y":0.06633495670846633},{"x":5.596160405783688,"y":0.0846788852687438},{"x":5.714918018786942,"y":0.10628152936488063},{"x":5.833675631790196,"y":0.13115668728217666},{"x":5.95243324479345,"y":0.1591376949843478},{"x":6.0711908577967035,"y":0.18984784355382314},{"x":6.1899484707999575,"y":0.22268361059029787},{"x":6.308706083803211,"y":0.25681525703293306},{"x":6.427463696806465,"y":0.29120804474674206},{"x":6.546221309809719,"y":0.32466531681600486},{"x":6.664978922812973,"y":0.3558921472266119},{"x":6.783736535816227,"y":0.38357553106900016},{"x":6.902494148819481,"y":0.4064745560197961},{"x":7.021251761822735,"y":0.423512093723718},{"x":7.140009374825989,"y":0.4338586377614926},{"x":7.258766987829243,"y":0.436999219096334},{"x":7.377524600832497,"y":0.4327758860735978},{"x":7.496282213835751,"y":0.42140087039975443},{"x":7.615039826839005,"y":0.4034389112374495},{"x":7.733797439842259,"y":0.3797607869594722},{"x":7.852555052845513,"y":0.35147337765935005},{"x":7.9713126658487665,"y":0.31983407542636144},{"x":8.090070278852021,"y":0.28615873665714536},{"x":8.208827891855275,"y":0.2517324880875947},{"x":8.32758550485853,"y":0.2177316218640706},{"x":8.446343117861783,"y":0.18516279494060392},{"x":8.565100730865037,"y":0.15482316037366273},{"x":8.683858343868291,"y":0.1272823279694955},{"x":8.802615956871545,"y":0.10288457599489102},{"x":8.921373569874799,"y":0.0817678192194962},{"x":9.040131182878053,"y":0.06389465637146394},{"x":9.158888795881307,"y":0.049090408188962965},{"x":9.27764640888456,"y":0.03708333022273633},{"x":9.396404021887815,"y":0.027542971609765998},{"x":9.515161634891069,"y":0.02011374042734151},{"x":9.633919247894323,"y":0.014441917794302352},{"x":9.752676860897576,"y":0.010195461212909896},{"x":9.87143447390083,"y":0.007076831672070479},{"x":9.990192086904084,"y":0.004829707565060443},{"x":10.108949699907338,"y":0.0032408041459838326},{"x":10.227707312910592,"y":0.0021381330021786583},{"x":10.346464925913846,"y":0.001386968599220493},{"x":10.4652225389171,"y":8.846032313311999E-4},{"x":10.583980151920354,"y":5.547283925225188E-4},{"x":10.702737764923608,"y":3.4202846314125487E-4},{"x":10.821495377926862,"y":2.073452467076015E-4}]}],"marks":[{"type":"line","from":{"data":"0005ecfd-f48d-462f-9c96-6d5d667a782f"},"properties":{"enter":{"x":{"scale":"x","field":"data.x"},"y":{"scale":"y","field":"data.y"},"stroke":{"value":"#FF29D2"},"strokeWidth":{"value":2},"strokeOpacity":{"value":1}}}}],"scales":[{"name":"x","type":"linear","range":"width","zero":false,"domain":{"data":"0005ecfd-f48d-462f-9c96-6d5d667a782f","field":"data.x"}},{"name":"y","type":"linear","range":"height","nice":true,"zero":false,"domain":{"data":"0005ecfd-f48d-462f-9c96-6d5d667a782f","field":"data.y"}}],"axes":[{"type":"x","scale":"x"},{"type":"y","scale":"y"}]},"value":"#gorilla_repl.vega.VegaView{:content {:width 400, :height 247.2188, :padding {:top 10, :left 55, :bottom 40, :right 10}, :data [{:name \"0005ecfd-f48d-462f-9c96-6d5d667a782f\", :values ({:x -0.9355083093952787, :y 1.5177457110710781E-18} {:x -0.8167506963920248, :y 4.832064651664273E-18} {:x -0.6979930833887709, :y 1.512573332331475E-17} {:x -0.5792354703855169, :y 4.655326256718623E-17} {:x -0.460477857382263, :y 1.4087495396429486E-16} {:x -0.34172024437900905, :y 4.1914803278814316E-16} {:x -0.22296263137575512, :y 1.2261710495065194E-15} {:x -0.10420501837250118, :y 3.526831122451236E-15} {:x 0.014552594630752758, :y 9.973974461209923E-15} {:x 0.1333102076340067, :y 2.7733317261431563E-14} {:x 0.25206782063726063, :y 7.582027733782066E-14} {:x 0.37082543364051457, :y 2.0380690703070383E-13} {:x 0.4895830466437685, :y 5.386447217013132E-13} {:x 0.6083406596470224, :y 1.3997030194327666E-12} {:x 0.7270982726502764, :y 3.5761800096868163E-12} {:x 0.8458558856535303, :y 8.983650001799444E-12} {:x 0.9646134986567843, :y 2.2188924730070884E-11} {:x 1.0833711116600382, :y 5.388522131513146E-11} {:x 1.2021287246632921, :y 1.2866281991230112E-10} {:x 1.320886337666546, :y 3.0205528652976314E-10} {:x 1.4396439506698, :y 6.972199370552141E-10} {:x 1.558401563673054, :y 1.5823521236501393E-9} {:x 1.6771591766763079, :y 3.5309084068029774E-9} {:x 1.7959167896795618, :y 7.746753737857518E-9} {:x 1.9146744026828157, :y 1.6711022715021897E-8} {:x 2.0334320156860697, :y 3.5443474545609617E-8} {:x 2.1521896286893236, :y 7.391277879006082E-8} {:x 2.2709472416925776, :y 1.5154888711630995E-7} {:x 2.3897048546958315, :y 3.055174029508333E-7} {:x 2.5084624676990854, :y 6.05576671456206E-7} {:x 2.6272200807023394, :y 1.180191004737103E-6} {:x 2.7459776937055933, :y 2.2614419522515046E-6} {:x 2.8647353067088472, :y 4.260578482264893E-6} {:x 2.983492919712101, :y 7.892265296470874E-6} {:x 3.102250532715355, :y 1.4374235708139969E-5} {:x 3.221008145718609, :y 2.574055042667626E-5} {:x 3.339765758721863, :y 4.532114543208098E-5} {:x 3.458523371725117, :y 7.845739899387076E-5} {:x 3.577280984728371, :y 1.3354170473500436E-4} {:x 3.696038597731625, :y 2.2348578581065146E-4} {:x 3.8147962107348787, :y 3.677332307639632E-4} {:x 3.9335538237381327, :y 5.949299450079775E-4} {:x 4.052311436741387, :y 9.463434088037403E-4} {:x 4.1710690497446405, :y 0.0014800680201936516} {:x 4.2898266627478945, :y 0.0022759597059693755} {:x 4.408584275751148, :y 0.0034411011894398577} {:x 4.527341888754402, :y 0.005115408246139013} {:x 4.646099501757656, :y 0.00747675475325276} {:x 4.76485711476091, :y 0.010744741027638978} {:x 4.883614727764164, :y 0.015181991719543044} {:x 5.002372340767418, :y 0.02109169724291865} {:x 5.121129953770672, :y 0.028810068303938962} {:x 5.239887566773926, :y 0.038692521081368086} {:x 5.35864517977718, :y 0.05109280528809409} {:x 5.477402792780434, :y 0.06633495670846633} {:x 5.596160405783688, :y 0.0846788852687438} {:x 5.714918018786942, :y 0.10628152936488063} {:x 5.833675631790196, :y 0.13115668728217666} {:x 5.95243324479345, :y 0.1591376949843478} {:x 6.0711908577967035, :y 0.18984784355382314} {:x 6.1899484707999575, :y 0.22268361059029787} {:x 6.308706083803211, :y 0.25681525703293306} {:x 6.427463696806465, :y 0.29120804474674206} {:x 6.546221309809719, :y 0.32466531681600486} {:x 6.664978922812973, :y 0.3558921472266119} {:x 6.783736535816227, :y 0.38357553106900016} {:x 6.902494148819481, :y 0.4064745560197961} {:x 7.021251761822735, :y 0.423512093723718} {:x 7.140009374825989, :y 0.4338586377614926} {:x 7.258766987829243, :y 0.436999219096334} {:x 7.377524600832497, :y 0.4327758860735978} {:x 7.496282213835751, :y 0.42140087039975443} {:x 7.615039826839005, :y 0.4034389112374495} {:x 7.733797439842259, :y 0.3797607869594722} {:x 7.852555052845513, :y 0.35147337765935005} {:x 7.9713126658487665, :y 0.31983407542636144} {:x 8.090070278852021, :y 0.28615873665714536} {:x 8.208827891855275, :y 0.2517324880875947} {:x 8.32758550485853, :y 0.2177316218640706} {:x 8.446343117861783, :y 0.18516279494060392} {:x 8.565100730865037, :y 0.15482316037366273} {:x 8.683858343868291, :y 0.1272823279694955} {:x 8.802615956871545, :y 0.10288457599489102} {:x 8.921373569874799, :y 0.0817678192194962} {:x 9.040131182878053, :y 0.06389465637146394} {:x 9.158888795881307, :y 0.049090408188962965} {:x 9.27764640888456, :y 0.03708333022273633} {:x 9.396404021887815, :y 0.027542971609765998} {:x 9.515161634891069, :y 0.02011374042734151} {:x 9.633919247894323, :y 0.014441917794302352} {:x 9.752676860897576, :y 0.010195461212909896} {:x 9.87143447390083, :y 0.007076831672070479} {:x 9.990192086904084, :y 0.004829707565060443} {:x 10.108949699907338, :y 0.0032408041459838326} {:x 10.227707312910592, :y 0.0021381330021786583} {:x 10.346464925913846, :y 0.001386968599220493} {:x 10.4652225389171, :y 8.846032313311999E-4} {:x 10.583980151920354, :y 5.547283925225188E-4} {:x 10.702737764923608, :y 3.4202846314125487E-4} {:x 10.821495377926862, :y 2.073452467076015E-4})}], :marks [{:type \"line\", :from {:data \"0005ecfd-f48d-462f-9c96-6d5d667a782f\"}, :properties {:enter {:x {:scale \"x\", :field \"data.x\"}, :y {:scale \"y\", :field \"data.y\"}, :stroke {:value \"#FF29D2\"}, :strokeWidth {:value 2}, :strokeOpacity {:value 1}}}}], :scales [{:name \"x\", :type \"linear\", :range \"width\", :zero false, :domain {:data \"0005ecfd-f48d-462f-9c96-6d5d667a782f\", :field \"data.x\"}} {:name \"y\", :type \"linear\", :range \"height\", :nice true, :zero false, :domain {:data \"0005ecfd-f48d-462f-9c96-6d5d667a782f\", :field \"data.y\"}}], :axes [{:type \"x\", :scale \"x\"} {:type \"y\", :scale \"y\"}]}}"}
;; <=

;; **
;;; ## Plot KL error as a function of number of samples
;; **

;; @@
(def num-sample-range 
  (mapv (comp int (partial * number-of-samples))
     [1e-3 2e-3 5e-3 1e-2 2e-2 5e-2 1e-1 2e-1 5e-1 1]))
  
(def KL-errors
  (map (fn [n]
         (let [mus (collect-by :result (take n samples))
			   mean (s/empirical-mean mus)
               sd (s/empirical-std mus)]
			(kl-normal 
              mean 
              sd 
              (:mean posterior) 
              (:sd posterior))))
       num-sample-range))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;gaussian-aistats/KL-errors</span>","value":"#'gaussian-aistats/KL-errors"}
;; <=

;; @@
(plot/list-plot (map vector 
                     (map #(/ (log %) 
                              (log 10)) 
                          num-sample-range)
                     (map #(/ (log %) 
                              (log 10)) 
                          KL-errors))
                :joined true
                :color "#05A"
                :x-title "log number of samples"
                :y-title "log KL divergence")
;; @@
;; =>
;;; {"type":"vega","content":{"width":400,"height":247.2187957763672,"padding":{"top":10,"left":55,"bottom":40,"right":10},"data":[{"name":"2516751d-39ee-4eb1-8086-cd748dfa4d66","values":[{"x":2.0,"y":-0.3156308817130661},{"x":2.301029995663981,"y":-0.7417094389860015},{"x":2.6989700043360183,"y":-1.6762060334969595},{"x":2.9999999999999996,"y":-2.184306051690168},{"x":3.301029995663981,"y":-3.031911585710226},{"x":3.6989700043360187,"y":-2.168257308616526},{"x":4.0,"y":-2.922147271737159},{"x":4.30102999566398,"y":-3.5375311780082352},{"x":4.698970004336019,"y":-3.3688278259724496},{"x":5.0,"y":-3.6383295779720775}]}],"marks":[{"type":"line","from":{"data":"2516751d-39ee-4eb1-8086-cd748dfa4d66"},"properties":{"enter":{"x":{"scale":"x","field":"data.x"},"y":{"scale":"y","field":"data.y"},"stroke":{"value":"#05A"},"strokeWidth":{"value":2},"strokeOpacity":{"value":1}}}}],"scales":[{"name":"x","type":"linear","range":"width","zero":false,"domain":{"data":"2516751d-39ee-4eb1-8086-cd748dfa4d66","field":"data.x"}},{"name":"y","type":"linear","range":"height","nice":true,"zero":false,"domain":{"data":"2516751d-39ee-4eb1-8086-cd748dfa4d66","field":"data.y"}}],"axes":[{"type":"x","scale":"x","title":"log number of samples","titleOffset":30},{"type":"y","scale":"y","title":"log KL divergence","titleOffset":45}]},"value":"#gorilla_repl.vega.VegaView{:content {:width 400, :height 247.2188, :padding {:top 10, :left 55, :bottom 40, :right 10}, :data [{:name \"2516751d-39ee-4eb1-8086-cd748dfa4d66\", :values ({:x 2.0, :y -0.3156308817130661} {:x 2.301029995663981, :y -0.7417094389860015} {:x 2.6989700043360183, :y -1.6762060334969595} {:x 2.9999999999999996, :y -2.184306051690168} {:x 3.301029995663981, :y -3.031911585710226} {:x 3.6989700043360187, :y -2.168257308616526} {:x 4.0, :y -2.922147271737159} {:x 4.30102999566398, :y -3.5375311780082352} {:x 4.698970004336019, :y -3.3688278259724496} {:x 5.0, :y -3.6383295779720775})}], :marks [{:type \"line\", :from {:data \"2516751d-39ee-4eb1-8086-cd748dfa4d66\"}, :properties {:enter {:x {:scale \"x\", :field \"data.x\"}, :y {:scale \"y\", :field \"data.y\"}, :stroke {:value \"#05A\"}, :strokeWidth {:value 2}, :strokeOpacity {:value 1}}}}], :scales [{:name \"x\", :type \"linear\", :range \"width\", :zero false, :domain {:data \"2516751d-39ee-4eb1-8086-cd748dfa4d66\", :field \"data.x\"}} {:name \"y\", :type \"linear\", :range \"height\", :nice true, :zero false, :domain {:data \"2516751d-39ee-4eb1-8086-cd748dfa4d66\", :field \"data.y\"}}], :axes [{:type \"x\", :scale \"x\", :title \"log number of samples\", :titleOffset 30} {:type \"y\", :scale \"y\", :title \"log KL divergence\", :titleOffset 45}]}}"}
;; <=
